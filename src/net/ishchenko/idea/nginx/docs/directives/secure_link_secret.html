<h2> <span class="mw-headline" id="secure_link_secret"> secure_link_secret </span></h2><p><b>syntax:</b> <i>secure_link_secret secret_word</i> </p><p><b>default:</b> <i>none</i> </p><p><b>context:</b> <i>location</i> </p><p>The directive specifies a secret word to be used when computing the MD5 hash to verify the requests. The full URL for a protected links follows this form: </p><p>/<b>prefix</b>/<i>MD5 hash</i>/<b>reference</b> </p><p>where the <i>MD5 hash</i> is computed by concatenating the reference to the protected link with the secret_word specified in the <b>secret</b> directive. For example, the link being protected is <i>top_secret_file.pdf</i> located under the directory <i>p</i>. The nginx configuration is: </p><div dir="ltr" class="mw-geshi" style="text-align: left;">
 <div class="nginx source-nginx">
  <pre class="de1"><a href="/NginxHttpCoreModule#location"><span class="kw3">location</span></a> /p/ <span class="br0">{</span>
    secure_link_secret segredo<span class="sy0">;</span>
&nbsp;
    <span class="co1"># If the hash is incorrect then $secure_link has the value of the null string.</span>
    <a href="/NginxHttpRewriteModule#if"><span class="kw22">if</span></a> <span class="br0">(</span><span class="re0">$secure_link</span> <span class="sy0">=</span> <span class="st0">&quot;&quot;</span><span class="br0">)</span> <span class="br0">{</span>
        <a href="/NginxHttpRewriteModule#return"><span class="kw22">return</span></a> <span class="nu0">403</span><span class="sy0">;</span>
    <span class="br0">}</span>
&nbsp;
    <span class="co1"># This needs to be here otherwise you'll get a 404.</span>
    <a href="/NginxHttpRewriteModule#rewrite"><span class="kw22">rewrite</span></a> ^ /p/<span class="re0">$secure_link</span> <a href="/NginxHttpRewriteModule#break"><span class="kw22">break</span></a><span class="sy0">;</span>
<span class="br0">}</span></pre>
 </div>
</div><p>You can compute the MD5 hash using the <a href="http://www.openssl.org/docs/apps/openssl.html" class="external text" rel="nofollow">openssl</a> command line utility. We'll concatenate the protected link, <i>top_secret_file.pdf</i>, with the secret word, <i>segredo</i>. </p><pre>
echo -n 'top_secret_file.pdfsegredo' | openssl dgst -md5
</pre><p>You'll get the hash <b>0849e9c72988f118896724a0502b92a8</b>. Now you can access the protected file using the URL: </p><pre>
http://example.com/p/0849e9c72988f118896724a0502b92a8/top_secret_file.pdf
</pre><p>Note that the prefix, i.e., the path leading to the protected links, must be different from the root path. You can only use secure_link on non-root paths. Hence the following is <b>illegal</b>: </p><div dir="ltr" class="mw-geshi" style="text-align: left;">
 <div class="nginx source-nginx">
  <pre class="de1"><a href="/NginxHttpCoreModule#location"><span class="kw3">location</span></a> / <span class="br0">{</span>
   <span class="co1"># This is wrong, wrong, wrong. It's a root path!</span>
   secure_link_secret segredo<span class="sy0">;</span>
   <span class="br0">[</span>...<span class="br0">]</span>
<span class="br0">}</span></pre>
 </div>
</div><br><i>Module: HttpSecureLinkModule</i>